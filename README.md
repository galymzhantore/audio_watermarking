# Audio Watermarking via Matrix Decomposition

![Python](https://img.shields.io/badge/Python-3.8%2B-blue)
![License](https://img.shields.io/badge/license-MIT-green)
![Status](https://img.shields.io/badge/status-Research%20Project-orange)

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–µ—Ç–æ–¥—ã –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ (Digital Watermarking) –≤ –∞—É–¥–∏–æ—Ñ–∞–π–ª—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–∞—Ç—Ä–∏—á–Ω—ã—Ö —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–π. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫—Ä—ã—Ç–æ –≤–Ω–µ–¥—Ä—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–±–∏—Ç–æ–≤—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏) –≤ –∞—É–¥–∏–æ—Å–∏–≥–Ω–∞–ª, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –Ω–µ–∑–∞–º–µ—Ç–Ω–æ—Å—Ç—å—é –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é –∫ –∞—Ç–∞–∫–∞–º.

---

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

### –í–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫

![–í–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫](demo/watermark.png)

### –ê—É–¥–∏–æ

| –û–ø–∏—Å–∞–Ω–∏–µ | –§–∞–π–ª |
|-------------------------|------|
| –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∞—É–¥–∏–æ | [üéµ freddie.wav](demo/freddie.wav) |
| –ê—É–¥–∏–æ —Å –≤–æ–¥—è–Ω—ã–º –∑–Ω–∞–∫–æ–º | [üéµ watermarked_freddie.wav](demo/watermarked_freddie.wav) |

---

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

* **5 –ú–µ—Ç–æ–¥–æ–≤ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ **SVD**, **QR**, **LU**, **Schur**, –∞ —Ç–∞–∫–∂–µ –Ω–æ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ **—Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è –•–æ–ª–µ—Ü–∫–æ–≥–æ**.
* **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ–π–≤–ª–µ—Ç-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (LWT) –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –£–æ–ª—à–∞-–ê–¥–∞–º–∞—Ä–∞ (FWHT) –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ç—Ä–∏—Ü –∏–∑ –∞—É–¥–∏–æ-—Ñ—Ä–µ–π–º–æ–≤.
* **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –•–∞–æ—Ç–∏—á–µ—Å–∫–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (Chaotic Encryption) –≤–Ω–µ–¥—Ä—è–µ–º–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
* **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–æ—Ç–∏–≤ —Å–∂–∞—Ç–∏—è (AAC), —à—É–º–∞, —Ä–µ—Å—ç–º–ø–ª–∏–Ω–≥–∞, —ç—Ö–æ –∏ –¥—Ä—É–≥–∏—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π.
* **–ù–æ–≤–∞—è –∞—Ç–∞–∫–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –∞—Ç–∞–∫–∏, –Ω–∞—Ü–µ–ª–µ–Ω–Ω—ã–π –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞.

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
git clone https://github.com/RedSp1ke/audio_watermarking.git
cd audio_watermarking
pip install -r requirements.txt

```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–µ—Ç–æ–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ SVD –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞:

```python
import numpy as np
from watermarking import SVDMethod, CholeskyMethod
from utils import load_audio, save_audio, bit_error_rate

# 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
audio_signal, fs = load_audio('data/original.wav')
watermark_bits = np.random.randint(0, 2, 128)  # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á/–∑–Ω–∞–∫

# 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (SVD –∏–ª–∏ –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥ Cholesky)
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: quantization_step (Q) –∏ scaling (beta)
algo = SVDMethod(quantization=0.5, block_size=256)

# 3. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ (Embedding)
watermarked_audio = algo.embed(audio_signal, watermark_bits)
save_audio('data/stego_audio.wav', watermarked_audio, fs)

# 4. –ê—Ç–∞–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞)
# attacked_audio = add_noise(watermarked_audio, snr=20)

# 5. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ (Extraction)
extracted_bits = algo.extract(watermarked_audio)

# 6. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
ber = bit_error_rate(watermark_bits, extracted_bits)
print(f"Bit Error Rate: {ber:.4f}")

```

---

## –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

### –û–±—â–∏–π –ø–∞–π–ø–ª–∞–π–Ω

1. **–§—Ä–µ–π–º–∏–Ω–≥:** –ê—É–¥–∏–æ—Å–∏–≥–Ω–∞–ª $x[n]$ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –±–ª–æ–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ $N$
2. **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è:** –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è LWT –∏ FWHT –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã $A \in \mathbb{R}^{m \times m}$
3. **–†–∞–∑–ª–æ–∂–µ–Ω–∏–µ:** –ú–∞—Ç—Ä–∏—Ü–∞ $A$ —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –º–µ—Ç–æ–¥–æ–≤
4. **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ:** –ë–∏—Ç $b \in \{0, 1\}$ –≤–Ω–µ–¥—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ –Ω–∞–∏–±–æ–ª—å—à–µ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–π

| –ú–µ—Ç–æ–¥ | –§–æ—Ä–º—É–ª–∞ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è | –¶–µ–ª–µ–≤–æ–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-------|-------------------|---------------------|------------|
| **SVD** | $A = U \Sigma V^T$ | $\sigma_1$ (–Ω–∞–∏–±–æ–ª—å—à–µ–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —á–∏—Å–ª–æ) | –°–∞–º—ã–π —É—Å—Ç–æ–π—á–∏–≤—ã–π |
| **QR** | $A = QR$ | $\max(R_{ii})$ | –û—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ |
| **Schur** | $A = UTU^H$ | $\max(T_{ii})$ | –í–µ—Ä—Ö–Ω–µ—Ç—Ä–µ—É–≥–æ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ |
| **Cholesky** | $A = LL^T$ | $\max(L_{ii})$ | –¢—Ä–µ–±—É–µ—Ç $A \succ 0$ |
| **LU** | $A = LU$ | $\max(U_{ii})$ | –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π |

### –§–æ—Ä–º—É–ª–∞ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è

–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –±–∏—Ç–∞ $b$ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ $C_{max}$:

$$Y = \left\lfloor \frac{C_{max}}{\Delta} \right\rfloor$$

–≥–¥–µ $\Delta$ ‚Äî —à–∞–≥ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è. –ï—Å–ª–∏ —á—ë—Ç–Ω–æ—Å—Ç—å $Y \mod 2$ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –±–∏—Ç–æ–º $b$, –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è:

$$C'_{max} = \begin{cases} (Y+1) \cdot \Delta & \text{–µ—Å–ª–∏ } Y \mod 2 \neq b \\ Y \cdot \Delta & \text{–∏–Ω–∞—á–µ} \end{cases}$$

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –§–æ—Ä–º—É–ª–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|----------|
| **SNR** | $10 \log_{10} \frac{\sum x^2}{\sum (x-\hat{x})^2}$ | –û—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª/—à—É–º (–¥–ë) |
| **BER** | $\frac{\sum (b_i \neq \hat{b}_i)}{N} \cdot 100\%$ | –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –±–∏—Ç–æ–≤—ã—Ö –æ—à–∏–±–æ–∫ |
| **NC** | $\frac{\sum b_i \hat{b}_i}{\sqrt{\sum b_i^2 \sum \hat{b}_i^2}}$ | –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è |


---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –ê—Ç–∞–∫–∏

–í —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ –±—ã–ª–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Ä—è–¥—É –∞—Ç–∞–∫:

1. **–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –∞—Ç–∞–∫–∏:**
* –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞, –†–µ—Å—ç–º–ø–ª–∏–Ω–≥, Dropout.
* –°–∂–∞—Ç–∏–µ AAC (128 kbps).
* –≠—Ö–æ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞–º–ø–ª–∏—Ç—É–¥—ã.


2. **–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∞—Ç–∞–∫–∞ ("–ó–∞—Ç–∏—Ä–∞–Ω–∏–µ"):**
* –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –∞—Ç–∞–∫–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è –æ–±—Ä–∞—Ç–Ω–æ–µ SVD –∏ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—à–∏—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö —á–∏—Å–µ–ª. –û–Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–¥–∞–ª—è–µ—Ç –≤–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–∏–µ–º–ª–µ–º–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –∑–≤—É–∫–∞ .

–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã :

* **SVD** –ø–æ–∫–∞–∑–∞–ª –Ω–∞–∏–ª—É—á—à—É—é —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (–Ω–∏–∑–∫–∏–π BER) —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤.
* –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ **Cholesky** –ø–æ–∫–∞–∑–∞–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ QR –∏ SD, –ø—Ä–µ–≤–∑–æ–π–¥—è LU –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞.

---

## –ê–≤—Ç–æ—Ä—ã

–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –∫–æ–º–∞–Ω–¥–æ–π (NLA Project) :
* **–î–∞–≤—ã–¥–æ–≤ –ö–∏—Ä–∏–ª–ª**
* **–†–∞–¥—É—à–µ–≤ –î–∞–Ω–∏–∏–ª**
* **–ë—É–∑–∞–Ω–æ–≤ –ù–∏–∫–∏—Ç–∞**
* **–ì–∞–ª—ã–º–∂–∞–Ω –ñ–∞–Ω—Ç–æ—Ä–µ**
* **–¶–µ—Ä–µ–Ω–≥ –°–µ—Ä–≥–µ–π**

---

## –°—Å—ã–ª–∫–∏

1. Pranab Kumar Dhar, Tetsuya Shimamura, *Advances in Audio Watermarking Based on Matrix Decomposition*.